<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <small>v1.0.1</small>

    <hr>

    <button id="scanButton">Scan</button>
    <button id="writeButton">Write</button>
    <button id="makeReadOnlyButton" disabled>Make Read-Only</button>

    <hr>

    <i id="output"></i>

    <script>
        const log = (text) => {
            document.getElementById("output").innerHTML += text + "<br>";
        }

        scanButton.addEventListener("click", async () => {
            log("User clicked scan button");

            

            try {
                const ndef = new NDEFReader();
                await ndef.scan();
                log("> Scan started");

                ndef.addEventListener("readingerror", () => {
                    log("Argh! Cannot read data from the NFC tag. Try another one?");
                });

                ndef.addEventListener("reading", ({ message, serialNumber }) => {
                    log(`> Serial Number: ${serialNumber}`);
                    log(`> Records: (${message.records.length})`);
                    log(`> Message: (${message.records})`);
                    log(`> Message: (${JSON.stringify(message)})`);
                });
            } catch (error) {
                log("Argh! " + error);
            }
        });

        writeButton.addEventListener("click", async () => {
            log("User clicked write button");

            try {
                const ndef = new NDEFReader();
                await ndef.write("Hello world!");
                log("> Message written");
            } catch (error) {
                log("Argh! " + error);
            }
        });

        makeReadOnlyButton.addEventListener("click", async () => {
            log("User clicked make read-only button");

            try {
                const ndef = new NDEFReader();
                //await ndef.makeReadOnly();
                log("> NFC tag has been made permanently read-only");
            } catch (error) {
                log("Argh! " + error);
            }
        });
    </script>
</body>

</html>